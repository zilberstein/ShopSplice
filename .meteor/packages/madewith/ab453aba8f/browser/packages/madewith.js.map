{"version":3,"file":"/packages/madewith.js","sources":["madewith/madewith.html","madewith/madewith.js"],"names":[],"mappings":";;;;;;;;AAAA,whB;;;;;;;;;;;;;;;;;;;ACAA,4C;AACA,oC;AACA,gD;AACA,4C;;AAEA,uD;AACA,gD;AACA,8C;;AAEA,wD;AACA,wE;;AAEA,gB;AACA,6B;AACA,wD;AACA,2D;AACA,G;AACA,G;;AAEA,2C;AACA,2B;AACA,mC;AACA,E;;AAEA,2C;AACA,mB;AACA,E;;AAEA,0B;AACA,6C;AACA,6B;AACA,Y;AACA,oC;;AAEA,kE;AACA,W;AACA,4B;AACA,2B;AACA,G;AACA,G","sourcesContent":["Meteor.startup(function(){document.body.appendChild(Spark.render(Template.__define__(null,Package.handlebars.Handlebars.json_ast_to_func([[\">\",\"madewith\"]]))));});Template.__define__(\"madewith\",Package.handlebars.Handlebars.json_ast_to_func([\"<a class=\\\"madewith_badge\\\" href=\\\"http://madewith.meteor.com/\",[\"{\",[[0,\"shortname\"]]],\"\\\" target=\\\"_blank\\\">\\n    <div class=\\\"madewith_votes\\\">\\n      <div class=\\\"madewith_upvote\\\"></div>\\n      <div class=\\\"madewith_vote_count\\\">\",[\"{\",[[0,\"vote_count\"]]],\"</div>\\n    </div>\\n  </a>\"]));\n","// automatically capture this app's hostname\nvar hostname = window.location.host;\nvar match = hostname.match(/(.*)\\.meteor.com$/);\nvar shortname = match ? match[1] : hostname;\n\n// connect to madewith and subscribe to my app's record\nvar server = DDP.connect(\"madewith.meteor.com\");\nvar sub = server.subscribe(\"myApp\", hostname);\n\n// minimongo collection to hold my singleton app record.\nvar apps = new Meteor.Collection('madewith_apps', {connection: server});\n\nserver.methods({\n  vote: function (hostname) {\n    // This is a stub, so it doesn't need to call check.\n    apps.update({name: hostname}, {$inc: {vote_count: 1}});\n  }\n});\n\nTemplate.madewith.vote_count = function() {\n  var app = apps.findOne();\n  return app ? app.vote_count : '';\n};\n\nTemplate.madewith.shortname = function () {\n  return shortname;\n};\n\nTemplate.madewith.events({\n  'click .madewith_upvote': function(event) {\n    var app = apps.findOne();\n    if (app)\n      server.call('vote', hostname);\n\n    // stop these so you don't click through the link to go to the\n    // app.\n    event.stopPropagation();\n    event.preventDefault();\n  }\n});\n"]}