{"version":3,"file":"/packages/email:tests.js","sources":["email/email_tests.js"],"names":[],"mappings":";;;;;;;;AAAA,kD;;AAEA,6D;AACA,yE;AACA,mC;;AAEA,O;AACA,wD;AACA,2C;AACA,gB;AACA,8B;AACA,4B;AACA,yD;AACA,qC;AACA,yD;AACA,mD;AACA,O;AACA,gF;AACA,sE;AACA,4D;AACA,kD;AACA,gD;AACA,wC;AACA,qD;AACA,4C;AACA,0C;AACA,mE;AACA,mD;AACA,8D;AACA,kE;AACA,uB;AACA,uC;AACA,qC;AACA,+B;AACA,8C;AACA,a;AACA,oC;AACA,G;AACA,G","sourcesContent":["var streamBuffers = Npm.require('stream-buffers');\n\nTinytest.add(\"email - dev mode smoke test\", function (test) {\n  // This only tests dev mode, so don't run the test if this is deployed.\n  if (process.env.MAIL_URL) return;\n\n  try {\n    var stream = new streamBuffers.WritableStreamBuffer;\n    EmailTest.overrideOutputStream(stream);\n    Email.send({\n      from: \"foo@example.com\",\n      to: \"bar@example.com\",\n      cc: [\"friends@example.com\", \"enemies@example.com\"],\n      subject: \"This is the subject\",\n      text: \"This is the body\\nof the message\\nFrom us.\",\n      headers: {'X-Meteor-Test': 'a custom header'}\n    });\n    // Note that we use the local \"stream\" here rather than Email._output_stream\n    // in case a concurrent test run mutates Email._output_stream too.\n    // XXX brittle if mailcomposer changes header order, etc\n    test.equal(stream.getContentsAsString(\"utf8\"),\n               \"====== BEGIN MAIL #0 ======\\n\" +\n               \"MIME-Version: 1.0\\r\\n\" +\n               \"X-Meteor-Test: a custom header\\r\\n\" +\n               \"From: foo@example.com\\r\\n\" +\n               \"To: bar@example.com\\r\\n\" +\n               \"Cc: friends@example.com, enemies@example.com\\r\\n\" +\n               \"Subject: This is the subject\\r\\n\" +\n               \"Content-Type: text/plain; charset=utf-8\\r\\n\" +\n               \"Content-Transfer-Encoding: quoted-printable\\r\\n\" +\n               \"\\r\\n\" +\n               \"This is the body\\r\\n\" +\n               \"of the message\\r\\n\" +\n               \"From us.\\r\\n\" +\n               \"====== END MAIL #0 ======\\n\");\n  } finally {\n    EmailTest.restoreOutputStream();\n  }\n});\n"]}