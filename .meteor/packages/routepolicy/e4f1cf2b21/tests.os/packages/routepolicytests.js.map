{"version":3,"file":"/packages/routepolicy:tests.js","sources":["routepolicy/routepolicy_tests.js"],"names":[],"mappings":";;;;;;;;AAAA,uD;AACA,iD;;AAEA,wC;AACA,mD;AACA,uD;;AAEA,yC;AACA,4C;AACA,+C;;AAEA,qD;AACA,wD;;AAEA,gE;AACA,qE;;AAEA,6D;AACA,a;AACA,2C;AACA,0C;AACA,I;AACA,G;;AAEA,gE;AACA,kB;AACA,K;AACA,kD;AACA,uB;AACA,wB;AACA,0C;AACA,M;AACA,K;AACA,oC;AACA,uB;AACA,wB;AACA,4B;AACA,K;AACA,I;AACA,iD;;AAEA,a;AACA,uE;AACA,uF;AACA,I;;AAEA,a;AACA,kF;AACA,Q;AACA,I;AACA,G;;AAEA,8D;AACA,iD;AACA,wC;;AAEA,a;AACA,gD;AACA,gD;AACA,I;;AAEA,a;AACA,0C;AACA,oC;AACA,I;;AAEA,a;AACA,uD;AACA,mF;AACA,I;AACA,G","sourcesContent":["Tinytest.add(\"routepolicy - declare\", function (test) {\n  var policy = new RoutePolicyTest.Constructor();\n\n  policy.declare('/sockjs/', 'network');\n  policy.declare('/bigphoto.jpg', 'static-online');\n  policy.declare('/anotherphoto.png', 'static-online');\n\n  test.equal(policy.classify('/'), null);\n  test.equal(policy.classify('/foo'), null);\n  test.equal(policy.classify('/sockjs'), null);\n\n  test.equal(policy.classify('/sockjs/'), 'network');\n  test.equal(policy.classify('/sockjs/foo'), 'network');\n\n  test.equal(policy.classify('/bigphoto.jpg'), 'static-online');\n  test.equal(policy.classify('/bigphoto.jpg.orig'), 'static-online');\n\n  test.equal(policy.urlPrefixesFor('network'), ['/sockjs/']);\n  test.equal(\n    policy.urlPrefixesFor('static-online'),\n    ['/anotherphoto.png', '/bigphoto.jpg']\n  );\n});\n\nTinytest.add(\"routepolicy - static conflicts\", function (test) {\n  var manifest = [\n    {\n      \"path\": \"static/sockjs/socks-are-comfy.jpg\",\n      \"type\": \"static\",\n      \"where\": \"client\",\n      \"url\": \"/sockjs/socks-are-comfy.jpg\"\n    },\n    {\n      \"path\": \"static/bigphoto.jpg\",\n      \"type\": \"static\",\n      \"where\": \"client\",\n      \"url\": \"/bigphoto.jpg\"\n    }\n  ];\n  var policy = new RoutePolicyTest.Constructor();\n\n  test.equal(\n    policy.checkForConflictWithStatic('/sockjs/', 'network', manifest),\n    \"static resource /sockjs/socks-are-comfy.jpg conflicts with network route /sockjs/\"\n  );\n\n  test.equal(\n    policy.checkForConflictWithStatic('/bigphoto.jpg', 'static-online', manifest),\n    null\n  );\n});\n\nTinytest.add(\"routepolicy - checkUrlPrefix\", function (test) {\n  var policy = new RoutePolicyTest.Constructor();\n  policy.declare('/sockjs/', 'network');\n\n  test.equal(\n    policy.checkUrlPrefix('foo/bar', 'network'),\n    \"a route URL prefix must begin with a slash\"\n  );\n\n  test.equal(\n    policy.checkUrlPrefix('/', 'network'),\n    \"a route URL prefix cannot be /\"\n  );\n\n  test.equal(\n    policy.checkUrlPrefix('/sockjs/', 'static-online'),\n    \"the route URL prefix /sockjs/ has already been declared to be of type network\"\n  );\n});\n"]}